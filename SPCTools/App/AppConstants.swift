import Foundation

enum AppConstants {
    enum SPC {
        // Control chart factors for X-bar R charts (sample sizes 2-25)
        static let A2: [Int: Double] = [
            2: 1.880, 3: 1.023, 4: 0.729, 5: 0.577,
            6: 0.483, 7: 0.419, 8: 0.373, 9: 0.337, 10: 0.308,
            11: 0.285, 12: 0.266, 13: 0.249, 14: 0.235, 15: 0.223,
            16: 0.212, 17: 0.203, 18: 0.194, 19: 0.187, 20: 0.180,
            21: 0.173, 22: 0.167, 23: 0.162, 24: 0.157, 25: 0.153
        ]

        static let D3: [Int: Double] = [
            2: 0, 3: 0, 4: 0, 5: 0,
            6: 0, 7: 0.076, 8: 0.136, 9: 0.184, 10: 0.223,
            11: 0.256, 12: 0.284, 13: 0.308, 14: 0.329, 15: 0.348,
            16: 0.364, 17: 0.379, 18: 0.392, 19: 0.404, 20: 0.414,
            21: 0.425, 22: 0.434, 23: 0.443, 24: 0.452, 25: 0.459
        ]

        static let D4: [Int: Double] = [
            2: 3.267, 3: 2.575, 4: 2.282, 5: 2.115,
            6: 2.004, 7: 1.924, 8: 1.864, 9: 1.816, 10: 1.777,
            11: 1.744, 12: 1.716, 13: 1.692, 14: 1.671, 15: 1.652,
            16: 1.636, 17: 1.621, 18: 1.608, 19: 1.596, 20: 1.586,
            21: 1.575, 22: 1.566, 23: 1.557, 24: 1.548, 25: 1.541
        ]

        static let d2: [Int: Double] = [
            2: 1.128, 3: 1.693, 4: 2.059, 5: 2.326,
            6: 2.534, 7: 2.704, 8: 2.847, 9: 2.970, 10: 3.078,
            11: 3.173, 12: 3.258, 13: 3.336, 14: 3.407, 15: 3.472,
            16: 3.532, 17: 3.588, 18: 3.640, 19: 3.689, 20: 3.735,
            21: 3.778, 22: 3.819, 23: 3.858, 24: 3.895, 25: 3.931
        ]

        // I-MR chart constants (E2 = 2.660 for moving range of 2)
        static let E2: Double = 2.660
        static let D3_MR: Double = 0.0
        static let D4_MR: Double = 3.267

        // Standard 1.5σ shift for Six Sigma
        static let sigmaShift: Double = 1.5

        // Helper accessors
        static func a2(n: Int) -> Double { A2[n] ?? 0 }
        static func d3(n: Int) -> Double { D3[n] ?? 0 }
        static func d4(n: Int) -> Double { D4[n] ?? 0 }
        static func d2Value(n: Int) -> Double { d2[n] ?? 0 }
    }

    enum AQL {
        // ISO 2859-1 Sample size code letters
        // Key: (lotSizeRange, inspectionLevel) → code letter
        static let codeLetter: [(min: Int, max: Int, S1: String, S2: String, S3: String, S4: String, I: String, II: String, III: String)] = [
            (2, 8, "A", "A", "A", "A", "A", "A", "B"),
            (9, 15, "A", "A", "A", "A", "A", "B", "C"),
            (16, 25, "A", "A", "B", "B", "B", "C", "D"),
            (26, 50, "A", "B", "B", "C", "C", "D", "E"),
            (51, 90, "B", "B", "C", "C", "C", "E", "F"),
            (91, 150, "B", "B", "C", "D", "D", "F", "G"),
            (151, 280, "B", "C", "D", "E", "E", "G", "H"),
            (281, 500, "B", "C", "D", "E", "F", "H", "J"),
            (501, 1200, "C", "C", "E", "F", "G", "J", "K"),
            (1201, 3200, "C", "D", "E", "G", "H", "K", "L"),
            (3201, 10000, "C", "D", "F", "G", "J", "L", "M"),
            (10001, 35000, "C", "D", "F", "H", "K", "M", "N"),
            (35001, 150000, "D", "E", "G", "J", "L", "N", "P"),
            (150001, 500000, "D", "E", "G", "J", "M", "P", "Q"),
            (500001, Int.max, "D", "E", "H", "K", "N", "Q", "R"),
        ]

        // Sample sizes by code letter
        static let sampleSize: [String: Int] = [
            "A": 2, "B": 3, "C": 5, "D": 8, "E": 13,
            "F": 20, "G": 32, "H": 50, "J": 80, "K": 125,
            "L": 200, "M": 315, "N": 500, "P": 800, "Q": 1250, "R": 2000
        ]

        // Normal inspection Ac/Re by (code letter, AQL)
        // AQL values: 0.065, 0.10, 0.15, 0.25, 0.40, 0.65, 1.0, 1.5, 2.5, 4.0, 6.5
        static let aqlValues: [Double] = [0.065, 0.10, 0.15, 0.25, 0.40, 0.65, 1.0, 1.5, 2.5, 4.0, 6.5]

        // Accept/Reject numbers: (Ac, Re) - (-1, -1) means use arrow (different sample size)
        static let normalTable: [String: [(Int, Int)]] = [
            "A": [(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(0,1),(0,1)],
            "B": [(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(0,1),(0,1),(1,2)],
            "C": [(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(0,1),(0,1),(1,2),(2,3)],
            "D": [(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(0,1),(0,1),(1,2),(2,3),(3,4)],
            "E": [(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(0,1),(0,1),(1,2),(2,3),(3,4),(5,6)],
            "F": [(-1,-1),(-1,-1),(-1,-1),(-1,-1),(0,1),(0,1),(1,2),(2,3),(3,4),(5,6),(7,8)],
            "G": [(-1,-1),(-1,-1),(-1,-1),(0,1),(0,1),(1,2),(2,3),(3,4),(5,6),(7,8),(10,11)],
            "H": [(-1,-1),(-1,-1),(0,1),(0,1),(1,2),(2,3),(3,4),(5,6),(7,8),(10,11),(14,15)],
            "J": [(-1,-1),(0,1),(0,1),(1,2),(2,3),(3,4),(5,6),(7,8),(10,11),(14,15),(21,22)],
            "K": [(0,1),(0,1),(1,2),(2,3),(3,4),(5,6),(7,8),(10,11),(14,15),(21,22),(-1,-1)],
            "L": [(0,1),(1,2),(2,3),(3,4),(5,6),(7,8),(10,11),(14,15),(21,22),(-1,-1),(-1,-1)],
            "M": [(1,2),(2,3),(3,4),(5,6),(7,8),(10,11),(14,15),(21,22),(-1,-1),(-1,-1),(-1,-1)],
            "N": [(2,3),(3,4),(5,6),(7,8),(10,11),(14,15),(21,22),(-1,-1),(-1,-1),(-1,-1),(-1,-1)],
            "P": [(3,4),(5,6),(7,8),(10,11),(14,15),(21,22),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1)],
            "Q": [(5,6),(7,8),(10,11),(14,15),(21,22),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1)],
            "R": [(7,8),(10,11),(14,15),(21,22),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1),(-1,-1)],
        ]
    }

    enum Subscription {
        static let revenueCatAPIKey = "test_wOouLCUCouhsRYrRWoKpdTxtLbC"
        static let entitlementID = "pro"
        static let monthlyProductID = "com.spctools.pro.monthly"
        static let yearlyProductID = "com.spctools.pro.yearly"
    }
}
